<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign Up</title>
  <link rel="stylesheet" href="styles/dashboard.min.css" />
  <link rel="stylesheet" href="styles/login.min.css" />
</head>
<body>
  <h1>Create an Account</h1>

  <form method="POST" action="/signup">
    <label>Username:
      <input type="text" name="username" required style="text-transform: lowercase;" />
    </label><br />

    <label>Password:
      <input type="password" name="password" required />
    </label><br />

    <label>Role:
      <select name="role" required>
        <option value="tenant">Tenant</option>
        <option value="landlord">Landlord</option>
      </select>
    </label><br />

    <button type="submit">Sign Up</button>
  </form>

  <p>Already have an account? <a href="/login.html">Log in</a></p>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      const usernameInput = document.querySelector('input[name="username"]');

      // Enforce lowercase input
      usernameInput.addEventListener('input', e => {
        e.target.value = e.target.value.toLowerCase();
      });

      // Dynamic feedback
      if (params.get('error') === 'exists') {
        const msg = document.createElement('p');
        msg.textContent = '❌ That email is already registered.';
        msg.style.color = 'red';
        document.body.prepend(msg);
      }

      if (params.get('error') === 'server') {
        const msg = document.createElement('p');
        msg.textContent = '⚠️ Server error. Please try again.';
        msg.style.color = 'orange';
        document.body.prepend(msg);
      }
    });
  </script>
</body>
</html>