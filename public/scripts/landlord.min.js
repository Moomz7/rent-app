document.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("tenant-list"),e=document.getElementById("repair-requests"),n=document.getElementById("payment-history"),a=document.getElementById("welcome-message");try{const t=await fetch("/api/current-user"),e=await t.json();a.textContent=`Welcome back, ${e.username}!`}catch{a.textContent="Welcome back!"}try{const a=await fetch("/api/tenants").then(t=>t.json());t.innerHTML=a.map(t=>`<p>👤 ${t.username}</p>`).join("");const o=await fetch("/api/requests").then(t=>t.json());e.innerHTML=o.map(t=>`\n      <div class="request-item">\n        <p>🛠️ ${t.tenant}: ${t.issue} – Status: ${t.status}</p>\n        ${"Resolved"!==t.status?`<button data-id="${t._id}" class="resolve-btn">Mark as Resolved</button>`:""}\n      </div>\n    `).join(""),document.querySelectorAll(".resolve-btn").forEach(t=>{t.addEventListener("click",async()=>{const e=t.getAttribute("data-id"),n=await fetch(`/api/requests/${e}/resolve`,{method:"POST"}),a=await n.json();t.parentElement.querySelector("p").textContent=`🛠️ ${a.tenant}: ${a.issue} – Status: ${a.status}`,t.remove()})});const s=await fetch("/api/payments").then(t=>t.json());n.innerHTML=s.map(t=>`\n      <p>💰 ${t.tenant} paid $${t.amount} on ${new Date(t.date).toLocaleDateString()}</p>\n    `).join("")}catch(a){t.textContent="Error loading tenants",e.textContent="Error loading requests",n.textContent="Error loading payments",console.error(a)}document.addEventListener("DOMContentLoaded",()=>{!async function(){const t=await fetch("/api/requests"),e=await t.json(),n=document.getElementById("requests-container");n.innerHTML="",e.forEach(t=>{const e=document.createElement("div");e.className="request-card",e.innerHTML=`\n      <p><strong>${t.tenant}</strong> reported: ${t.issue}</p>\n      <p>Status: ${t.status}</p>\n      <button data-id="${t._id}" class="resolve-btn">Mark Resolved</button>\n    `,n.appendChild(e)}),document.querySelectorAll(".resolve-btn").forEach(t=>{t.addEventListener("click",async()=>{const e=t.dataset.id,n=await fetch(`/api/requests/${e}/resolve`,{method:"POST"}),a=await n.json();t.parentElement.querySelector("p:nth-child(2)").textContent=`Status: ${a.status}`,t.remove()})})}(),async function(){const t=await fetch("/api/payments"),e=await t.json(),n=document.getElementById("payments-container");n.innerHTML="<h3>Recent Payments</h3>",e.forEach(t=>{const e=document.createElement("p");e.textContent=`${t.username} paid $${t.amount.toFixed(2)} on ${new Date(t.date).toLocaleDateString()}`,n.appendChild(e)})}()});const o=document.getElementById("logout-link");o&&o.addEventListener("click",function(t){t.preventDefault(),confirm("Are you sure you want to log out?")&&(window.location.href="/logout")})});